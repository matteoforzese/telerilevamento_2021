setwd("C:/lab/ESAME")
library(raster)  #permette l'utilizzo dei raster e funzioni annesse
library(RStoolbox) #permette l'uso della Unsupervised Classification
library(ggplot2)  #permette l'uso delle funzioni ggplot
library(gridExtra)   #permette l'uso e creazione di griglie, tabelle e grafici
library(rasterdiv)

H1979<-brick("STHE79.jpg")
H1980<-brick("STHE80.jpg")
H1982<-brick("STHE82.jpg") 
H1986<-brick("STHE86.jpg")
H1990<-brick("STHE90.jpg")
H1993<-brick("STHE93.jpg")
H1998<-brick("STHE98.jpg")
H2002<-brick("STHE02.jpg")
H2006<-brick("STHE06.jpg")
H2010<-brick("STHE10.jpg")
H2015<-brick("STHE15.jpg")

BWG<-colorRampPalette(c("black","white","green"))(100)

MSH1979 <- unsuperClass(H1979$STHE79.2, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1980 <- unsuperClass(H1980$STHE80.2, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1982 <- unsuperClass(H1982$STHE82.2, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1986 <- unsuperClass(H1986$STHE86.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1990 <- unsuperClass(H1990$STHE90.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1993 <- unsuperClass(H1993$STHE93.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH1998 <- unsuperClass(H1998$STHE98.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH2002 <- unsuperClass(H2002$STHE02.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH2006 <- unsuperClass(H2006$STHE06.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH2010 <- unsuperClass(H2010$STHE10.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)
MSH2015 <- unsuperClass(H2015$STHE15.1, nClasses=3,stretch="lin", clusterMap = TRUE, norm = TRUE)

par(mfrow=c(3,3))
plot(MSH1979$map, col=BWG)
plot(MSH1980$map, col=BWG)
plot(MSH1982$map, col=BWG)
plot(MSH1986$map, col=BWG)
plot(MSH1990$map, col=BWG)
plot(MSH1993$map, col=BWG)
plot(MSH1998$map, col=BWG)
plot(MSH2002$map, col=BWG)
plot(MSH2006$map, col=BWG)

plot(MSH1979$map, col=BWG)
freq(MSH1979$map)
plot(MSH1980$map, col=BWG)
freq(MSH1980$map)
plot(MSH1982$map, col=BWG)
freq(MSH1982$map)
plot(MSH1986$map, col=BWG)
freq(MSH1986$map)
plot(MSH1990$map, col=BWG)
freq(MSH1990$map)
plot(MSH1993$map, col=BWG)
freq(MSH1993$map)
plot(MSH1998$map, col=BWG)
freq(MSH1998$map)
plot(MSH2002$map, col=BWG)
freq(MSH2002$map)
plot(MSH2006$map, col=BWG)
freq(MSH2006$map)
plot(MSH2010$map, col=BWG)
freq(MSH2010$map)
plot(MSH2015$map, col=BWG)
freq(MSH2015$map)







BWG<-colorRampPalette(c("black","white","green"))(100)
GWB<-colorRampPalette(c("green","white","black"))(100)
par(mfrow=c(3,1), no.readonly = FALSE)

plot(MSH1979$map, col=BWG)
plot(MSH1982$map, col=BWG)
plot(MSH1986$map, col=BWG) 
plotRGB(H1982, r=2, g=2, b=1)


H1979<-reclassify(H1979, cbind(253:255, NA))
H1980<-reclassify(H1980, cbind(253:255, NA))
H1982<-reclassify(H1982, cbind(253:255, NA))
H1986<-reclassify(H1986, cbind(253:255, NA))

par(mfrow=c(3,4), no.readonly = FALSE)
MSH1979 <- unsuperClass(H1979$STHE79.2, nClasses=2,stretch="lin")
plot(MSH1979$map, col=BWG)
MSH1980 <- unsuperClass(H1980$STHE80.2, nClasses=2,stretch="lin")
plot(MSH1980$map, col=BWG)
MSH1982 <- unsuperClass(H1982$STHE82.2, nClasses=2,stretch="lin")
plot(MSH1982$map, col=BWG)
MSH1986 <- unsuperClass(H1986$STHE86.1, nClasses=2,stretch="lin")
plot(MSH1986$map, col=BWG)
MSH1990 <- unsuperClass(H1990$STHE90.1, nClasses=2,stretch="lin")
plot(MSH1990$map, col=BWG)
MSH1993 <- unsuperClass(H1993$STHE93.1, nClasses=2,stretch="lin")
plot(MSH1993$map, col=BWG)
MSH1998 <- unsuperClass(H1998$STHE98.1, nClasses=2,stretch="lin")
plot(MSH1998$map, col=BWG)
MSH2002 <- unsuperClass(H2002$STHE02.1, nClasses=2,stretch="lin")
plot(MSH2002$map, col=BWG)
MSH2006 <- unsuperClass(H2006$STHE06.1, nClasses=2,stretch="lin")
plot(MSH2006$map, col=BWG)
MSH2010 <- unsuperClass(H2010$STHE10.1, nClasses=2,stretch="lin")
plot(MSH2010$map, col=BWG)
MSH2015 <- unsuperClass(H2015$STHE15.1, nClasses=2,stretch="lin")
plot(MSH2015$map, col=BWG)


MSH1979 <- unsuperClass(H1979$STHE79.3, nClasses=2,stretch="lin")
MSH1980 <- unsuperClass(H1980$STHE80.3, nClasses=2,stretch="lin")
MSH1982 <- unsuperClass(H1982$STHE82.3, nClasses=2,stretch="lin")
AMSH1979 <- unsuperClass(H1979$STHE79.3, nClasses=2,stretch="lin")
AMSH1980 <- unsuperClass(H1980$STHE80.3, nClasses=2,stretch="lin")
AMSH1982 <- unsuperClass(H1982$STHE82.3, nClasses=2,stretch="lin")
plot(MSH1979$map)
plot(MSH1980$map)
plot(MSH1982$map)
plot(AMSH1979$map)
plot(AMSH1980$map)
plot(AMSH1982$map)

par(mfrow=c(2,3))
plot(H1980$STHE80.1)
plot(H1980$STHE80.2)
plot(H1980$STHE80.3)
plot(H1986$STHE86.1)
plot(H1986$STHE86.2)
plot(H1986$STHE86.3)

par(mfrow=c(3,2))
plot(H1979$STHE79.2)
plot(MSH1979$map)
plot(H1980$STHE80.2)
plot(MSH1980$map)
plot(H1986$STHE86.1)
plot(MSH1986$map)
